{% extends 'base.html.twig' %}

{% block title %}
	{{ page_title ?? 'Books List' }}
	- RSYWX Library
{% endblock %}

{% block body %}
	<div class="container mt-4">
		<div class="row mb-4">
			<div class="col-12">
				<h1>
					<i class="{{ page_icon ?? 'bi bi-book' }}"></i>
					{{ page_title ?? 'Books List' }}</h1>
				<p class="lead">{{ page_description ?? 'Browse our collection of books' }}</p>
			</div>
		</div>

		{% if books is not empty %}
			<!-- Books Count -->
			<div class="row mb-3">
				<div class="col-12">
					<div class="d-flex justify-content-between align-items-center">
						<span class="text-muted">

							第{{ pagination.current_page }}页 / 总{{ pagination.total_pages }}页

						</span>
					</div>
				</div>
			</div>

			<!-- Books List -->
			<div class="row">
				<div class="col-12">
					<table class="table table-striped table-hover">
						<thead>
							<tr>
								<th>书籍编号</th>
								<th>书名</th>
								<th>作者</th>
								<th>位置</th>
							</tr>
						</thead>
						<tbody>
							{% for book in books %}
								<tr>
									<td>{{ book.bookid }}</td>
									<td>
										<a href="{{ path('book_details', {bookId: book.bookid}) }}" title="{{ book.title }}">
											{{ book.title }}
										</a>
									</td>
									<td title="{{ book.author }}">
										<a href="{{ path('books_list', {key: 'author', value: book.author}) }}">
											{{ book.author }}
										</a>
									</td>
									<td title="{{ book.location }}">{{ book.location }}</td>
								</tr>
							{% endfor %}
						</tbody>
					</table>
				</div>
			</div>

			<!-- Pagination -->
			{% if pagination and pagination.total_pages > 1 %}
				<div class="row mt-4">
					<div class="col-12">
						<nav aria-label="Books pagination">
							<ul class="pagination justify-content-center">
								<!-- First Page -->
								{% if pagination.current_page > 1 %}
									<li class="page-item">
										<a class="page-link" href="{{ path('books_list', {key: searchKey, value: searchValue, page: 1}) }}">
											<i class="bi bi-chevron-double-left"></i>
											首页
										</a>
									</li>
								{% else %}
									<li class="page-item disabled">
										<span class="page-link">
											<i class="bi bi-chevron-double-left"></i>
											首页</span>
									</li>
								{% endif %}

								<!-- Previous Page -->
								{% if pagination.current_page > 1 %}
									<li class="page-item">
										<a class="page-link" href="{{ path('books_list', {key: searchKey, value: searchValue, page: pagination.current_page - 1}) }}">
											<i class="bi bi-chevron-left"></i>
											前一页
										</a>
									</li>
								{% else %}
									<li class="page-item disabled">
										<span class="page-link">
											<i class="bi bi-chevron-left"></i>
											前一页</span>
									</li>
								{% endif %}


								<!-- Next Page -->
								{% if pagination.current_page < pagination.total_pages %}
									<li class="page-item">
										<a class="page-link" href="{{ path('books_list', {key: searchKey, value: searchValue, page: pagination.current_page + 1}) }}">
											后一页
											<i class="bi bi-chevron-right"></i>
										</a>
									</li>
								{% else %}
									<li class="page-item disabled">
										<span class="page-link">后一页
											<i class="bi bi-chevron-right"></i>
										</span>
									</li>
								{% endif %}

								<!-- Last Page -->
								{% if pagination.current_page < pagination.total_pages %}
									<li class="page-item">
										<a class="page-link" href="{{ path('books_list', {key: searchKey, value: searchValue, page: pagination.total_pages}) }}">
											末页
											<i class="bi bi-chevron-double-right"></i>
										</a>
									</li>
								{% else %}
									<li class="page-item disabled">
										<span class="page-link">末页
											<i class="bi bi-chevron-double-right"></i>
										</span>
									</li>
								{% endif %}
							</ul>
						</nav>
					</div>
				</div>
			{% endif %}

		{% else %}
			<!-- No Books Found -->
			<div class="row">
				<div class="col-12">
					<div class="alert alert-info text-center" role="alert">
						<i class="bi bi-info-circle display-4 mb-3"></i>
						<h4>No Books Found</h4>
						<p class="mb-3">{{ empty_message|default('No books match the current criteria.') }}</p>
						<div class="btn-group" role="group">
							<a href="{{ path('books_dashboard') }}" class="btn btn-primary">
								<i class="bi bi-speedometer2"></i>
								Dashboard
							</a>
							<a href="{{ path('books_search') }}" class="btn btn-outline-primary">
								<i class="bi bi-search"></i>
								Search Books
							</a>
						</div>
					</div>
				</div>
			</div>
		{% endif %}

		<!-- Navigation -->

	</div>
{% endblock %}
