<!-- Navigation -->
<nav class="navbar navbar-expand-lg fixed-top">
    <div class="container">
        <a class="navbar-brand" href="{{ path('app_home') }}">
            <img src="{{ asset('images/logo.svg') }}" alt="RSYWX Logo" style="height: 40px; width: auto; margin-right: 8px;"> 任氏有无轩       </a>
        
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
            <span class="navbar-toggler-icon"></span>
        </button>
        
        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav mx-auto">
                <li class="nav-item">
                    <a class="nav-link" href="{{ path('app_home') }}">首页</a>
                </li>
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">藏书</a>
                    <ul class="dropdown-menu">
                        <li><a class="dropdown-item" href="{{ path('books_list') }}">藏书总目</a></li>
                        <li><a class="dropdown-item" href="{{ path('books_today') }}">今日藏书</a></li>
                        <li><a class="dropdown-item" href="{{ path('books_lucky') }}">手气不错</a></li>
                        <li><hr class="dropdown-divider"></li>
                        <li><a class="dropdown-item" href="{{ path('books_visit_records') }}">访问记录</a></li>
                    </ul>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="{{ path('reading_index') }}">
                        读书
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="https://blog.rsywx.net" target="_blank">
                        博客 <i class="bi bi-box-arrow-up-right"></i>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="https://rsywx.com" target="_blank">
                        维客 <i class="bi bi-box-arrow-up-right"></i>
                    </a>
                </li>
                
                <li class="nav-item">
                    <a class="nav-link" href="{{ path('about') }}">关于</a>
                </li>
            </ul>
            
            <!-- Search Form -->
            <form class="d-flex search-box" method="GET" action="{{ path('books_list', {key: 'misc', value: '__PLACEHOLDER__', page: 1}) }}" onsubmit="return updateSearchAction(this)">
                <input class="form-control me-2" type="search" name="search_query" placeholder="搜索图书..." aria-label="搜索" required>
                <button class="btn btn-outline-light" type="submit">
                    <i class="bi bi-search"></i>
                </button>
            </form>
            
            <script>
            function updateSearchAction(form) {
                const searchInput = form.querySelector('input[name="search_query"]');
                const searchValue = searchInput.value.trim();
                if (searchValue) {
                    const newUrl = "{{ path('books_list', {key: 'misc', value: '__VALUE__', page: 1}) }}".replace('__VALUE__', encodeURIComponent(searchValue));
                    window.location.href = newUrl;
                    return false; // Prevent default form submission
                }
                return false;
            }
            </script>
        </div>
    </div>
</nav>